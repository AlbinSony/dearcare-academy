<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DearCare Academy - Course Enquiry</title>
    <!-- Import Poppins font to match index.html -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/register.css">
    <link rel="shortcut icon" href="assets/images/dearcare-favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <div class="page-transition"></div>
    <!-- Add Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- Add header navigation matching index.html -->
    <header class="header" id="header">
        <nav class="navbar container flexitem">
            <a href="index.html" aria-label="DearCare Academy Homepage"><img src="assets/images/academyNav.png" loading="lazy" alt="DearCare Logo" width="190" height="auto" class="nav-logo-img"></a>
            
            <div class="nav-menu" id="nav-menu">
                <i class="fa-solid fa-xmark" id="nav-close" aria-label="Close menu"></i>
                <ul class="nav-list flexitem">
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="index.html#popular" class="nav-link">Courses</a></li>
                    <li><a href="index.html#learn" class="nav-link">About</a></li>
                    <li><a href="index.html#testimonials" class="nav-link">Testimonials</a></li>
                    <li><a href="index.html#faq" class="nav-link">FAQs</a></li>
                    <li><a href="index.html#contact" class="nav-link">Contact Us</a></li>
                </ul>
            </div>
            <i class="fa-solid fa-bars" id="nav-toggle" aria-label="Open menu"></i>
        </nav>
    </header>

    <!-- Add back button below the header -->
    <div class="back-button-container">
        <button class="back-button" id="backButton" aria-label="Go back">
            <i class="fas fa-arrow-left"></i> Go back
        </button>
    </div>

    <div class="registration-container">
        <header class="form-header">
            <h1 class="gradient-text">Course Enquiry Form</h1>
            <p>Interested in our healthcare courses? Fill in your details and we'll get back to you shortly.</p>
        </header>

        <form id="enquiryForm" class="registration-form">
            <!-- Personal Information Section -->
            <section class="form-section">
                <h2><i class="fas fa-user"></i> Personal Information</h2>
                <p class="section-description">Tell us about yourself. Fields marked with * are required.</p>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="fullName">Full Name*</label>
                        <input type="text" id="fullName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address*</label>
                        <input type="email" id="email" name="email" required>
                        <small class="form-hint">We'll send course information to this address</small>
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone Number*</label>
                        <input type="tel" id="phone" name="phone_no" placeholder="10-digit number" pattern="[0-9]{10}" required>
                        <small class="form-hint">Example: 9876543210</small>
                    </div>
                    <div class="form-group">
                        <label for="gender">Gender</label>
                        <select id="gender" name="gender">
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dob">Date of Birth</label>
                        <input type="date" id="dob" name="dob">
                    </div>
                    <div class="form-group">
                        <label for="age">Age</label>
                        <input type="number" id="age" name="age" class="enhanced-input" placeholder="Enter your age" min="18">
                        <small class="form-hint">Must be 18 years or older</small>
                    </div>
                    <div class="form-group">
                        <label for="religion">Religion</label>
                        <input type="text" id="religion" name="religion">
                    </div>
                    <div class="form-group">
                        <label for="caste">Caste</label>
                        <input type="text" id="caste" name="caste">
                    </div>
                </div>
            </section>

            <!-- Contact & Address Section -->
            <section class="form-section">
                <h2><i class="fas fa-map-marker-alt"></i> Contact & Address</h2>
                <p class="section-description">Where can we reach you?</p>
                <div class="form-grid">
                    <div class="form-group grid-full">
                        <label for="address">Address</label>
                        <textarea id="address" name="address" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="aadhaar">Aadhaar Number</label>
                        <input type="text" id="aadhaar" name="aadhaar_no" pattern="[0-9]{12}" placeholder="12-digit Aadhaar">
                        <small class="form-hint">Enter 12 digits without spaces</small>
                    </div>
                    <div class="form-group">
                        <label for="guardian">Guardian Name</label>
                        <input type="text" id="guardian" name="guardian_name">
                    </div>
                </div>
            </section>

            <!-- Education Section -->
            <section class="form-section">
                <h2><i class="fas fa-graduation-cap"></i> Educational Background</h2>
                <p class="section-description">Tell us about your academic qualifications.</p>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="highestQualification">Highest Qualification</label>
                        <input type="text" id="highestQualification" name="highest_qualification">
                    </div>
                    <div class="form-group">
                        <label for="yearOfPassing">Year of Passing</label>
                        <input type="number" id="yearOfPassing" name="year_of_passing" class="enhanced-input" placeholder="Enter your passing year">
                    </div>
                </div>
            </section>

            <!-- Course Selection Section -->
            <section class="form-section">
                <h2><i class="fas fa-book"></i> Course Selection</h2>
                <p class="section-description">Select the course you're interested in.</p>
                <div class="form-grid">
                    <div class="form-group grid-full">
                        <label for="course">Course of Interest*</label>
                        <select id="course" name="course" required>
                            <option value="">Select Course</option>
                            <option value="Advanced General Nursing Assistant (AGDA)">General Nursing Assistant (GDA)</option>
                            <option value="Advanced Home Nursing & Patient Care Training">Advanced Home Care & Care Giver Training</option>
                            <option value="Ayurveda Nursing & Baby Care">Ayurvedic Nursing</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Submit Button -->
            <div class="form-submit">
                <button type="submit" class="btn submit-btn">
                    <i class="fas fa-paper-plane"></i> Submit Enquiry
                </button>
            </div>

            <!-- Success Message -->
            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle"></i>
                <h3>Enquiry Submitted Successfully!</h3>
                <p>Thank you for your interest in our courses. Our team will contact you soon with more information.</p>
                <div class="return-home">
                    <a href="index.html" class="btn">Return to Homepage</a>
                </div>
            </div>

            <!-- Error Message -->
            <div class="error-message" id="errorMessage">
                <i class="fas fa-exclamation-circle"></i>
                <h3>Submission Error</h3>
                <p id="errorText">There was an error submitting your enquiry. Please try again later.</p>
            </div>
        </form>
    </div>

    <script>
        // Progress Bar functionality
        window.onscroll = function() {
            updateProgressBar();
        };

        function updateProgressBar() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById("progressBar").style.width = scrolled + "%";
        }

        // Back button functionality
        document.getElementById('backButton').addEventListener('click', function() {
            window.history.back();
        });

        // Mobile Menu Toggle (matching index.html functionality)
        const navMenu = document.getElementById('nav-menu'),
              navToggle = document.getElementById('nav-toggle'),
              navClose = document.getElementById('nav-close');

        // Show mobile menu
        if(navToggle) {
            navToggle.addEventListener('click', () => {
                navMenu.classList.add('show-nav');
                document.body.style.overflow = 'hidden'; // Prevent scrolling when menu is open
            });
        }

        // Hide mobile menu
        if(navClose) {
            navClose.addEventListener('click', () => {
                navMenu.classList.remove('show-nav');
                document.body.style.overflow = ''; // Restore scrolling
            });
        }

        // Close mobile menu when clicking on a nav link
        const navLinks = document.querySelectorAll('.nav-link');
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                navMenu.classList.remove('show-nav');
                document.body.style.overflow = ''; // Restore scrolling
            });
        });

        // Auto-calculate age from DOB
        document.getElementById('dob').addEventListener('change', function() {
            const dobValue = this.value;
            if (dobValue) {
                const dob = new Date(dobValue);
                const today = new Date();
                let age = today.getFullYear() - dob.getFullYear();
                const monthDiff = today.getMonth() - dob.getMonth();
                
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dob.getDate())) {
                    age--;
                }
                
                // Check if age is at least 18
                if (age < 18) {
                    alert('You must be at least 18 years old to apply.');
                    this.value = '';
                    document.getElementById('age').value = '';
                } else {
                    document.getElementById('age').value = age;
                }
            }
        });

        // Add age input validation
        document.getElementById('age').addEventListener('input', function() {
            const age = parseInt(this.value);
            if (age < 18) {
                alert('You must be at least 18 years old to apply.');
                this.value = '';
            }
        });

        // Form submission handler for enquiry form
        document.getElementById('enquiryForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = document.querySelector('.submit-btn');
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
            submitBtn.disabled = true;
            document.querySelector('.form-submit').classList.add('loading');
            
            // Hide any previous messages
            document.getElementById('successMessage').classList.remove('show');
            document.getElementById('errorMessage').classList.remove('show');
            
            try {
                // Get form data
                const formData = new FormData(this);
                
                // Create data object for API
                const apiData = {
                    name: formData.get('name'),
                    email: formData.get('email'),
                    phone_no: formData.get('phone_no'),
                    course: formData.get('course'),
                };

                // Add optional fields if they have values
                if (formData.get('age')) apiData.age = parseInt(formData.get('age'));
                if (formData.get('dob')) apiData.dob = formData.get('dob');
                if (formData.get('address')) apiData.address = formData.get('address');
                if (formData.get('gender')) apiData.gender = formData.get('gender');
                if (formData.get('religion')) apiData.religion = formData.get('religion');
                if (formData.get('caste')) apiData.caste = formData.get('caste');
                if (formData.get('aadhaar_no')) apiData.aadhaar_no = formData.get('aadhaar_no');
                if (formData.get('guardian_name')) apiData.guardian_name = formData.get('guardian_name');
                if (formData.get('highest_qualification')) apiData.highest_qualification = formData.get('highest_qualification');
                if (formData.get('year_of_passing')) apiData.year_of_passing = parseInt(formData.get('year_of_passing'));
                
                // Send the data to the API
                const response = await fetch('https://dearcare-academy.vercel.app/api/enquiry', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(apiData)
                });
                
                // Parse the response
                const responseData = await response.json();
                
                // Check if the response is OK
                if (!response.ok) {
                    throw new Error(responseData.error || 'Failed to submit the enquiry');
                }
                
                // Handle successful submission
                document.getElementById('successMessage').classList.add('show');
                
                // Reset form
                document.getElementById('enquiryForm').reset();
                
                // Scroll to success message
                document.getElementById('successMessage').scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                console.error('Error submitting form:', error);
                
                // Show error message
                document.getElementById('errorText').textContent = error.message || 'There was an error submitting your enquiry. Please try again later.';
                document.getElementById('errorMessage').classList.add('show');
                
                // Scroll to error message
                document.getElementById('errorMessage').scrollIntoView({ behavior: 'smooth' });
            } finally {
                // Reset submit button
                submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Submit Enquiry';
                submitBtn.disabled = false;
                document.querySelector('.form-submit').classList.remove('loading');
            }
        });
    </script>

    <style>
        /* Base styles */
        .form-section {
            margin-bottom: 2rem;
        }

        .section-description {
            color: #666;
            font-size: 0.95rem;
            margin-bottom: 1.5rem;
        }

        .form-hint {
            display: block;
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }

        /* Enhanced inputs with better styling */
        .enhanced-input {
            transition: all 0.3s ease;
            border-radius: 8px;
            border: 1px solid #ced4da;
            padding: 10px 16px;
            font-size: 16px;
            background-color: #fff;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
        }

        .enhanced-input:focus {
            border-color: #80bdff;
            background-color: #fff;
            box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.25);
        }

        .enhanced-input::placeholder {
            color: #adb5bd;
            font-style: italic;
        }

        /* Grid layouts */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .grid-full {
            grid-column: 1 / -1;
        }

        /* Responsive adjustment */
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Adjusted back button container to prevent navbar overlap */
        .back-button-container {
            padding: 25px 30px 0;
            max-width: 1200px;
            margin: 80px auto 0; /* Added top margin to ensure it's below fixed navbar */
            position: relative;
            z-index: 90; /* Below navbar z-index but still above other content */
        }
        
        /* Updated back button styling for better visibility */
        .back-button {
            display: inline-block;
            background: linear-gradient(90deg, rgba(28,121,194,1) 37%, rgba(72,193,86,1) 95%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(28, 121, 194, 0.2);
            transition: all 0.3s ease;
        }

        .back-button i {
            margin-right: 6px;
        }

        .back-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(28, 121, 194, 0.3);
        }

        /* Adjust the registration container top margin to maintain proper spacing */
        .registration-container {
            margin-top: 2rem; /* Reduced top margin since back button container now has margin */
        }

        @media screen and (max-width: 768px) {
            .back-button-container {
                padding: 15px 20px 0;
                margin-top: 70px; /* Slightly smaller top margin for mobile */
            }
            
            .back-button {
                padding: 8px 16px;
                font-size: 13px;
            }
        }
    </style>
</body>
</html>
