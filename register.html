<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DearCare Academy - Registration Form</title>
    <!-- Import Poppins font to match index.html -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/register.css">
    <link rel="shortcut icon" href="assets/images/dearcare-favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <div class="page-transition"></div>
    <!-- Add Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- Add header navigation matching index.html -->
    <header class="header" id="header">
        <nav class="navbar container flexitem">
            <a href="index.html" aria-label="DearCare Academy Homepage"><img src="assets/images/academyNav.png" loading="lazy" alt="DearCare Logo" width="190" height="auto" class="nav-logo-img"></a>
            
            <div class="nav-menu" id="nav-menu">
                <i class="fa-solid fa-xmark" id="nav-close" aria-label="Close menu"></i>
                <ul class="nav-list flexitem">
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="index.html#popular" class="nav-link">Courses</a></li>
                    <li><a href="index.html#learn" class="nav-link">About</a></li>
                    <li><a href="index.html#testimonials" class="nav-link">Testimonials</a></li>
                    <li><a href="index.html#faq" class="nav-link">FAQs</a></li>
                    <li><a href="index.html#contact" class="nav-link">Contact Us</a></li>
                </ul>
            </div>
            <i class="fa-solid fa-bars" id="nav-toggle" aria-label="Open menu"></i>
        </nav>
    </header>

    <!-- Add back button below the header -->
    <div class="back-button-container">
        <button class="back-button" id="backButton" aria-label="Go back">
            <i class="fas fa-arrow-left"></i> Go back
        </button>
    </div>

    <div class="registration-container">
        <header class="form-header">
            <h1 class="gradient-text">Course Registration Form</h1>
            <p>Please fill in all the required information carefully</p>
        </header>

        <form id="registrationForm" class="registration-form">
            <!-- Personal Information Section -->
            <section class="form-section">
                <h2><i class="fas fa-user"></i> Personal Information</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="fullName">Full Name*</label>
                        <input type="text" id="fullName" name="fullName" required>
                    </div>
                    <div class="form-group">
                        <label for="course">Course*</label>
                        <select id="course" name="course" required>
                            <option value="">Select Course</option>
                            <option value="Advanced General Nursing Assistant (AGDA)">Advanced General Nursing Assistant (AGDA)</option>
                            <option value="Diploma in Healthcare Assistance">Diploma in Healthcare Assistance</option>
                            <option value="Ayurveda Nursing & Baby Care">Ayurveda Nursing & Baby Care</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dob">Date of Birth*</label>
                        <input type="date" id="dob" name="dateOfBirth" required>
                    </div>
                    <div class="form-group">
                        <label for="age">Age*</label>
                        <input type="text" id="age" name="age" readonly required>
                    </div>
                    <div class="form-group">
                        <label for="gender">Gender*</label>
                        <select id="gender" name="gender" required>
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="maritalStatus">Marital Status*</label>
                        <select id="maritalStatus" name="maritalStatus" required>
                            <option value="">Select Status</option>
                            <option value="Single">Single</option>
                            <option value="Married">Married</option>
                            <option value="Separated">Separated</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Demographic Information -->
            <section class="form-section">
                <h2><i class="fas fa-globe"></i> Demographic Information</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nationality">Nationality*</label>
                        <input type="text" id="nationality" name="nationality" required>
                    </div>
                    <div class="form-group">
                        <label for="state">State*</label>
                        <input type="text" id="state" name="state" required>
                    </div>
                    <div class="form-group">
                        <label for="city">City*</label>
                        <input type="text" id="city" name="city" required>
                    </div>
                    <div class="form-group">
                        <label for="taluk">Taluk*</label>
                        <input type="text" id="taluk" name="taluk" required>
                    </div>
                    <div class="form-group">
                        <label for="motherTongue">Mother Tongue*</label>
                        <select id="motherTongue" name="motherTongue" required>
                            <option value="">Select Language</option>
                            <option value="English">English</option>
                            <option value="Hindi">Hindi</option>
                            <option value="Malayalam">Malayalam</option>
                            <option value="Tamil">Tamil</option>
                            <option value="Telugu">Telugu</option>
                            <option value="Kannada">Kannada</option>
                            <option value="Bengali">Bengali</option>
                            <option value="Marathi">Marathi</option>
                            <option value="Gujarati">Gujarati</option>
                            <option value="Urdu">Urdu</option>
                            <option value="Punjabi">Punjabi</option>
                            <option value="Odia">Odia</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="knownLanguages">Known Languages</label>
                        <input type="text" id="knownLanguages" name="knownLanguages" placeholder="Separate with commas">
                    </div>
                    <div class="form-group">
                        <label for="religion">Religion</label>
                        <input type="text" id="religion" name="religion">
                    </div>
                    <div class="form-group">
                        <label for="category">Category*</label>
                        <select id="category" name="category" required>
                            <option value="">Select Category</option>
                            <option value="General">General</option>
                            <option value="OBC">OBC</option>
                            <option value="SC">SC</option>
                            <option value="ST">ST</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Contact Information -->
            <section class="form-section">
                <h2><i class="fas fa-address-book"></i> Contact Information</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="email">Email Address*</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="mobile">Mobile Number*</label>
                        <input type="tel" id="mobile" name="mobileNumber" required>
                    </div>
                </div>
                
                <div class="address-section">
                    <h3>Current Address</h3>
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="currentAddress">Address*</label>
                            <textarea id="currentAddress" name="currentAddress" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="currentPin">PIN Code*</label>
                            <input type="text" id="currentPin" name="currentPinCode" required>
                        </div>
                    </div>
                </div>

                <div class="address-section">
                    <h3>Permanent Address</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <input type="checkbox" id="sameAddress" name="sameAddress">
                            <label for="sameAddress">Same as Current Address</label>
                        </div>
                        <div class="form-group full-width">
                            <label for="permanentAddress">Address*</label>
                            <textarea id="permanentAddress" name="permanentAddress" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="permanentPin">PIN Code*</label>
                            <input type="text" id="permanentPin" name="permanentPinCode" required>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Academic Information -->
            <section class="form-section">
                <h2><i class="fas fa-graduation-cap"></i> Academic Information</h2>
                
                <h3>SSLC (10th Grade)</h3>
                <div class="form-grid academic-entry">
                    <div class="form-group">
                        <label for="sslc-institution">Institution*</label>
                        <input type="text" id="sslc-institution" name="sslc-institution" required>
                    </div>
                    <div class="form-group">
                        <label for="sslc-year">Year of Passing*</label>
                        <input type="text" id="sslc-year" name="sslc-year" required>
                    </div>
                    <div class="form-group">
                        <label for="sslc-grade">Percentage/Grade*</label>
                        <input type="text" id="sslc-grade" name="sslc-grade" required>
                    </div>
                </div>
                
                <h3>HSC (12th Grade)</h3>
                <div class="form-grid academic-entry">
                    <div class="form-group">
                        <label for="hsc-institution">Institution*</label>
                        <input type="text" id="hsc-institution" name="hsc-institution" required>
                    </div>
                    <div class="form-group">
                        <label for="hsc-year">Year of Passing*</label>
                        <input type="text" id="hsc-year" name="hsc-year" required>
                    </div>
                    <div class="form-group">
                        <label for="hsc-grade">Percentage/Grade*</label>
                        <input type="text" id="hsc-grade" name="hsc-grade" required>
                    </div>
                </div>
                
                <h3>GDA (If applicable)</h3>
                <div class="form-grid academic-entry">
                    <div class="form-group">
                        <label for="gda-institution">Institution</label>
                        <input type="text" id="gda-institution" name="gda-institution">
                    </div>
                    <div class="form-group">
                        <label for="gda-year">Year of Passing</label>
                        <input type="text" id="gda-year" name="gda-year">
                    </div>
                    <div class="form-group">
                        <label for="gda-grade">Percentage/Grade</label>
                        <input type="text" id="gda-grade" name="gda-grade">
                    </div>
                </div>
                
                <h3>Others (If applicable)</h3>
                <div class="form-grid academic-entry">
                    <div class="form-group">
                        <label for="other-qualification">Qualification</label>
                        <input type="text" id="other-qualification" name="other-qualification">
                    </div>
                    <div class="form-group">
                        <label for="other-institution">Institution</label>
                        <input type="text" id="other-institution" name="other-institution">
                    </div>
                    <div class="form-group">
                        <label for="other-year">Year of Passing</label>
                        <input type="text" id="other-year" name="other-year">
                    </div>
                    <div class="form-group">
                        <label for="other-grade">Percentage/Grade</label>
                        <input type="text" id="other-grade" name="other-grade">
                    </div>
                </div>
            </section>

            <!-- Work Experience -->
            <section class="form-section">
                <h2><i class="fas fa-briefcase"></i> Work Experience</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="organization">Organization Name</label>
                        <input type="text" id="organization" name="organization">
                    </div>
                    <div class="form-group">
                        <label for="role">Role/Designation</label>
                        <input type="text" id="role" name="role">
                    </div>
                    <div class="form-group">
                        <label for="duration">Duration (months)</label>
                        <input type="text" id="duration" name="duration">
                    </div>
                    <div class="form-group full-width">
                        <label for="responsibilities">Responsibilities</label>
                        <textarea id="responsibilities" name="responsibilities"></textarea>
                    </div>
                </div>
            </section>

            <!-- Guardian Information -->
            <section class="form-section">
                <h2><i class="fas fa-users"></i> Guardian Information</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="guardianName">Guardian Name*</label>
                        <input type="text" id="guardianName" name="guardianName" required>
                    </div>
                    <div class="form-group">
                        <label for="relationship">Relationship*</label>
                        <input type="text" id="relationship" name="guardianRelation" required>
                    </div>
                    <div class="form-group">
                        <label for="guardianContact">Contact Number*</label>
                        <input type="tel" id="guardianContact" name="guardianContact" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="guardianAddress">Address*</label>
                        <textarea id="guardianAddress" name="guardianAddress" required></textarea>
                    </div>
                </div>
            </section>

            <!-- Additional Information -->
            <section class="form-section">
                <h2><i class="fas fa-info-circle"></i> Additional Information</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="aadhar">Aadhar Number*</label>
                        <input type="text" id="aadhar" name="guardianAadhar" required>
                    </div>
                    <div class="form-group">
                        <label for="healthStatus">Current Health Status</label>
                        <textarea id="healthStatus" name="healthStatus"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="disability">Disability Details (if any)</label>
                        <textarea id="disability" name="disability"></textarea>
                    </div>
                </div>
            </section>

            <!-- Document Uploads -->
            <section class="form-section">
                <h2><i class="fas fa-upload"></i> Document Uploads</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="photo">Photo* (JPEG format)</label>
                        <input type="file" id="photo" name="photo" accept="image/jpeg" required>
                    </div>
                    <div class="form-group">
                        <label for="documents">Documents* (PDF format)</label>
                        <input type="file" id="documents" name="documents" accept="application/pdf" required>
                    </div>
                    <div class="form-group">
                        <label for="nocCertificate">NOC Certificate (if applicable)</label>
                        <input type="file" id="nocCertificate" name="nocCertificate" accept="application/pdf">
                    </div>
                    <div class="form-group">
                        <label for="nocStatus">NOC Certificate Status*</label>
                        <select id="nocStatus" name="nocStatus" required>
                            <option value="">Select Status</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                            <option value="Applied">Applied</option>
                            <option value="Going To Apply">Going to Apply</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Source & Status -->
            <section class="form-section">
                <h2><i class="fas fa-clipboard-list"></i> Source & Status</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="sourceInfo">Source of Information*</label>
                        <select id="sourceInfo" name="sourceOfInformation" required>
                            <option value="">Select Source</option>
                            <option value="Leads From Facebook">Leads From Facebook</option>
                            <option value="Leads From IVR">Leads From IVR</option>
                            <option value="Leads From WhatsApp">Leads From WhatsApp</option>
                            <option value="Phone Landline">Phone Landline</option>
                            <option value="Justdial">Justdial</option>
                            <option value="Newspaper">Newspaper</option>
                            <option value="Client Reference">Client Reference</option>
                            <option value="Sulekha">Sulekha</option>
                            <option value="Direct Entry">Direct Entry</option>
                            <option value="Lead From CSV">Lead From CSV</option>
                            <option value="Referred By Person">Referred By Person</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="agent">Assigning Agent</label>
                        <input type="text" id="agent" name="assigningAgent">
                    </div>
                    <div class="form-group">
                        <label for="priority">Priority*</label>
                        <select id="priority" name="priority" required>
                            <option value="">Select Priority</option>
                            <option value="High">High</option>
                            <option value="Low">Low</option>
                            <option value="Negative">Negative</option>
                            <option value="Normal">Normal</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="status">Status*</label>
                        <select id="status" name="status" required>
                            <option value="">Select Status</option>
                            <option value="Confirmed">Confirmed</option>
                            <option value="Follow-up">Follow-up</option>
                            <option value="New">New</option>
                            <option value="Rejected">Rejected</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sourceCategory">Source Category</label>
                        <input type="text" id="sourceCategory" name="sourceCategory">
                    </div>
                    <div class="form-group">
                        <label for="sourceSubCategory">Source Sub-Category</label>
                        <input type="text" id="sourceSubCategory" name="sourceSubCategory">
                    </div>
                </div>
            </section>

            <!-- Preferences -->
            <section class="form-section">
                <h2><i class="fas fa-heart"></i> Care Preferences</h2>
                <div class="preferences-grid">
                    <div class="preference-item">
                        <label>Home Care Assistant</label>
                        <select name="homeCare" required>
                            <option value="">Select</option>
                            <option value="Interested">Interested</option>
                            <option value="Partially, If Trained">Partially, If Trained</option>
                            <option value="Not Interested">Not Interested</option>
                        </select>
                    </div>
                    <div class="preference-item">
                        <label>Delivery Care Assistant</label>
                        <select name="deliveryCare" required>
                            <option value="">Select</option>
                            <option value="Interested">Interested</option>
                            <option value="Partially, If Trained">Partially, If Trained</option>
                            <option value="Not Interested">Not Interested</option>
                        </select>
                    </div>
                    <div class="preference-item">
                        <label>Old Age Home/Rehabilitation Center</label>
                        <select name="oldAgeHome" required>
                            <option value="">Select</option>
                            <option value="Interested">Interested</option>
                            <option value="Partially, If Trained">Partially, If Trained</option>
                            <option value="Not Interested">Not Interested</option>
                        </select>
                    </div>
                    <div class="preference-item">
                        <label>Hospital Care</label>
                        <select name="hospitalCare" required>
                            <option value="">Select</option>
                            <option value="Interested">Interested</option>
                            <option value="Partially, If Trained">Partially, If Trained</option>
                            <option value="Not Interested">Not Interested</option>
                        </select>
                    </div>
                    <div class="preference-item">
                        <label>Critical Illness Care Assistant</label>
                        <select name="criticalCare" required>
                            <option value="">Select</option>
                            <option value="Interested">Interested</option>
                            <option value="Partially, If Trained">Partially, If Trained</option>
                            <option value="Not Interested">Not Interested</option>
                        </select>
                    </div>
                    <div class="preference-item">
                        <label>ICU Home Care Assistant</label>
                        <select name="icuCare" required>
                            <option value="">Select</option>
                            <option value="Interested">Interested</option>
                            <option value="Partially, If Trained">Partially, If Trained</option>
                            <option value="Not Interested">Not Interested</option>
                        </select>
                    </div>
                    <div class="preference-item">
                        <label>Senior Citizens Assistant</label>
                        <select name="seniorCare" required>
                            <option value="">Select</option>
                            <option value="Interested">Interested</option>
                            <option value="Partially, If Trained">Partially, If Trained</option>
                            <option value="Not Interested">Not Interested</option>
                        </select>
                    </div>
                    <div class="preference-item">
                        <label>Companion Ship Assistant</label>
                        <select name="companionship" required>
                            <option value="">Select</option>
                            <option value="Interested">Interested</option>
                            <option value="Partially, If Trained">Partially, If Trained</option>
                            <option value="Not Interested">Not Interested</option>
                        </select>
                    </div>
                    <div class="preference-item">
                        <label>Clinical Assistant</label>
                        <select name="clinicalAssistant" required>
                            <option value="">Select</option>
                            <option value="Interested">Interested</option>
                            <option value="Partially, If Trained">Partially, If Trained</option>
                            <option value="Not Interested">Not Interested</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Submit Button -->
            <div class="form-submit">
                <button type="submit" class="btn submit-btn">
                    <i class="fas fa-paper-plane"></i> Submit Application
                </button>
            </div>

            <!-- Success Message -->
            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle"></i>
                <h3>Registration Successful!</h3>
                <p>Your application has been submitted successfully. We'll get back to you soon.</p>
            </div>

            <!-- Error Message -->
            <div class="error-message" id="errorMessage">
                <i class="fas fa-exclamation-circle"></i>
                <h3>Submission Error</h3>
                <p id="errorText">There was an error submitting your application. Please try again later.</p>
            </div>
        </form>
    </div>

    <script>
        // Progress Bar functionality
        window.onscroll = function() {
            updateProgressBar();
        };

        function updateProgressBar() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById("progressBar").style.width = scrolled + "%";
        }

        // Back button functionality
        document.getElementById('backButton').addEventListener('click', function() {
            window.history.back();
        });

        // Calculate age from date of birth
        document.getElementById('dob').addEventListener('change', function() {
            const dob = new Date(this.value);
            const today = new Date();
            let age = today.getFullYear() - dob.getFullYear();
            const monthDiff = today.getMonth() - dob.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dob.getDate())) {
                age--;
            }
            
            document.getElementById('age').value = age.toString();
        });

        // Same Address Checkbox functionality
        document.getElementById('sameAddress').addEventListener('change', function() {
            if (this.checked) {
                document.getElementById('permanentAddress').value = document.getElementById('currentAddress').value;
                document.getElementById('permanentPin').value = document.getElementById('currentPin').value;
                document.getElementById('permanentAddress').disabled = true;
                document.getElementById('permanentPin').disabled = true;
            } else {
                document.getElementById('permanentAddress').disabled = false;
                document.getElementById('permanentPin').disabled = false;
            }
        });

        // Mobile Menu Toggle (matching index.html functionality)
        const navMenu = document.getElementById('nav-menu'),
              navToggle = document.getElementById('nav-toggle'),
              navClose = document.getElementById('nav-close');

        // Show mobile menu
        if(navToggle) {
            navToggle.addEventListener('click', () => {
                navMenu.classList.add('show-nav');
                document.body.style.overflow = 'hidden'; // Prevent scrolling when menu is open
            });
        }

        // Hide mobile menu
        if(navClose) {
            navClose.addEventListener('click', () => {
                navMenu.classList.remove('show-nav');
                document.body.style.overflow = ''; // Restore scrolling
            });
        }

        // Close mobile menu when clicking on a nav link
        const navLinks = document.querySelectorAll('.nav-link');
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                navMenu.classList.remove('show-nav');
                document.body.style.overflow = ''; // Restore scrolling
            });
        });

        // Form submission handler
        document.getElementById('registrationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = document.querySelector('.submit-btn');
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
            submitBtn.disabled = true;
            
            try {
                // Create the request data matching the exact structure that worked in Postman
                const formData = new FormData(this);
                const requestData = {
                    fullName: formData.get('fullName'),
                    course: formData.get('course'),
                    dateOfBirth: formData.get('dateOfBirth'),
                    age: formData.get('age'),
                    gender: formData.get('gender'),
                    maritalStatus: formData.get('maritalStatus'),
                    nationality: formData.get('nationality'),
                    state: formData.get('state'),
                    city: formData.get('city'),
                    taluk: formData.get('taluk'),
                    motherTongue: formData.get('motherTongue'),
                    knownLanguages: formData.get('knownLanguages'),
                    religion: formData.get('religion'),
                    category: formData.get('category'),
                    email: formData.get('email'),
                    mobileNumber: formData.get('mobileNumber'),
                    currentAddress: formData.get('currentAddress'),
                    currentPinCode: formData.get('currentPinCode'),
                    permanentAddress: formData.get('permanentAddress'),
                    permanentPinCode: formData.get('permanentPinCode'),
                    academics: {
                        sslc: {
                            institution: formData.get('sslc-institution'),
                            year: formData.get('sslc-year'),
                            grade: formData.get('sslc-grade')
                        },
                        hsc: {
                            institution: formData.get('hsc-institution'),
                            year: formData.get('hsc-year'),
                            grade: formData.get('hsc-grade')
                        },
                        gda: {
                            institution: formData.get('gda-institution') || '',
                            year: formData.get('gda-year') || '',
                            grade: formData.get('gda-grade') || ''
                        },
                        others: {
                            qualification: formData.get('other-qualification') || '',
                            institution: formData.get('other-institution') || '',
                            year: formData.get('other-year') || '',
                            grade: formData.get('other-grade') || ''
                        }
                    },
                    organization: formData.get('organization'),
                    role: formData.get('role'),
                    duration: formData.get('duration'),
                    responsibilities: formData.get('responsibilities'),
                    guardianName: formData.get('guardianName'),
                    guardianRelation: formData.get('relationship'),
                    guardianContact: formData.get('guardianContact'),
                    guardianAddress: formData.get('guardianAddress'),
                    guardianAadhar: formData.get('aadhar'),
                    healthStatus: formData.get('healthStatus'),
                    disability: formData.get('disability'),
                    nocStatus: formData.get('nocStatus'),
                    sourceOfInformation: formData.get('sourceOfInformation'),
                    assigningAgent: formData.get('agent'),
                    priority: formData.get('priority'),
                    status: formData.get('status'),
                    sourceCategory: formData.get('sourceCategory'),
                    sourceSubCategory: formData.get('sourceSubCategory'),
                    servicePreferences: {
                        "Home Care Assistant": formData.get('homeCare'),
                        "Hospital Care": formData.get('hospitalCare'),
                        "Senior Citizens Assistant": formData.get('seniorCare'),
                        "ICU Home Care Assistant": formData.get('icuCare'),
                        "Clinical Assistant": formData.get('clinicalAssistant'),
                        "Delivery Care Assistant": formData.get('deliveryCare'),
                        "Old Age Home/Rehabilitation Center": formData.get('oldAgeHome'),
                        "Critical Illness Care Assistant": formData.get('criticalCare'),
                        "Companion Ship Assistant": formData.get('companionship')
                    }
                };

                // Send the request
                const response = await fetch('https://dearcare-academy.vercel.app/api/register/students', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.message || 'Failed to submit the form');
                }

                // Handle successful submission
                document.getElementById('successMessage').classList.add('show');
                window.scrollTo({
                    top: document.getElementById('successMessage').offsetTop - 100,
                    behavior: 'smooth'
                });
                this.reset();
                
            } catch (error) {
                console.error('Error submitting form:', error);
                document.getElementById('errorMessage').classList.add('show');
                document.getElementById('errorText').textContent = error.message;
                window.scrollTo({
                    top: document.getElementById('errorMessage').offsetTop - 100,
                    behavior: 'smooth'
                });
            } finally {
                submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Submit Application';
                submitBtn.disabled = false;
            }
        });
    </script>

    <style>
        /* Adjusted back button container to prevent navbar overlap */
        .back-button-container {
            padding: 25px 30px 0;
            max-width: 1200px;
            margin: 80px auto 0; /* Added top margin to ensure it's below fixed navbar */
            position: relative;
            z-index: 90; /* Below navbar z-index but still above other content */
        }
        
        /* Updated back button styling for better visibility */
        .back-button {
            display: inline-block;
            background: linear-gradient(90deg, rgba(28,121,194,1) 37%, rgba(72,193,86,1) 95%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(28, 121, 194, 0.2);
            transition: all 0.3s ease;
        }

        .back-button i {
            margin-right: 6px;
        }

        .back-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(28, 121, 194, 0.3);
        }

        /* Adjust the registration container top margin to maintain proper spacing */
        .registration-container {
            margin-top: 2rem; /* Reduced top margin since back button container now has margin */
        }

        /* Fix for submit button and error message overlap in mobile view */
        .form-submit {
            margin-bottom: 30px; /* Increased bottom margin for better spacing */
            position: relative;
            z-index: 1;
        }

        .success-message,
        .error-message {
            display: none;
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0 35px; /* Added more margin for better spacing */
            text-align: center;
            position: relative;
            clear: both; /* Ensures it appears below the submit button */
            z-index: 2; /* Higher z-index than submit button */
        }

        .success-message.show,
        .error-message.show {
            display: block;
        }

        .error-message {
            background-color: rgba(255, 87, 87, 0.1);
            border: 1px solid #ff5757;
            color: #ff5757;
        }

        .error-message i {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        @media screen and (max-width: 768px) {
            .back-button-container {
                padding: 15px 20px 0;
                margin-top: 70px; /* Slightly smaller top margin for mobile */
            }
            
            .back-button {
                padding: 8px 16px;
                font-size: 13px;
            }

            /* Enhanced mobile-specific fixes for form submission area */
            /* Completely restructure the form submission area layout for mobile */
            .form-submit {
                margin-bottom: 20px; /* Reduced space below submit button */
                order: 2; /* Change the visual order on mobile */
            }

            .success-message,
            .error-message {
                margin: 0 0 30px; /* Adjust margins */
                padding: 15px 10px;
                order: 1; /* Display status messages before the button */
            }

            /* Make error message more visible */
            .error-message.show {
                z-index: 100; /* Ensure it's above other elements */
            }
            
            .error-message h3 {
                font-size: 1.1rem;
                margin-bottom: 8px;
            }
            
            /* Apply flexbox to rearrange elements on mobile */
            .registration-form {
                display: flex;
                flex-direction: column;
            }
            
            /* When status is shown, hide the submit button */
            .success-message.show ~ .form-submit,
            .error-message.show ~ .form-submit {
                display: none;
            }
            
            /* Alternative approach: Move status messages in DOM */
            .registration-form .success-message,
            .registration-form .error-message {
                position: relative;
                bottom: auto;
                left: auto;
                width: auto;
            }
        }
    </style>
</body>
</html>
